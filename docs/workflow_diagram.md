# FrameLeap åŠ¨æ€æ¼«ç”Ÿæˆæµç¨‹å›¾

## å¿«é€Ÿæ¦‚è§ˆ

```mermaid
flowchart TD
    subgraph Input["ğŸ“¥ è¾“å…¥å±‚"]
        A[é˜¶æ®µ1<br/>è¾“å…¥å¤„ç†]
    end

    subgraph Story["ğŸ“– æ•…äº‹åˆ›ä½œå±‚"]
        B[é˜¶æ®µ2<br/>å‰§æœ¬ç”Ÿæˆ]
        C[é˜¶æ®µ3<br/>ç”»é¢æè¿°]
        D[é˜¶æ®µ4<br/>å›¾åƒç”Ÿæˆ]
        G[é˜¶æ®µ7<br/>éŸ³é¢‘ç”Ÿæˆ]
    end

    subgraph Production["ğŸ¬ åˆ¶ä½œå±‚"]
        E[é˜¶æ®µ5<br/>è§†é¢‘ç”Ÿæˆ]
        F[é˜¶æ®µ6<br/>è§†é¢‘æ‹¼æ¥]
    end

    subgraph Output["ğŸ“¤ è¾“å‡ºå±‚"]
        H[é˜¶æ®µ8<br/>è¾“å‡ºäº¤ä»˜]
    end

    A --> B
    B --> C
    C --> D
    B --> G
    D --> E
    G --> E
    E --> F
    F --> H

    style A fill:#e1f5fe
    style B fill:#fff3e0
    style C fill:#fff3e0
    style D fill:#fff3e0
    style G fill:#fff3e0
    style E fill:#f3e5f5
    style F fill:#f3e5f5
    style H fill:#e8f5e9
```

---

## æ ¸å¿ƒå˜æ›´è¯´æ˜

### ä½¿ç”¨é€šä¹‰ä¸‡ç›¸ wan2.6-i2v API

**APIå‚æ•°**:
- `prompt`: æç¤ºè¯
- `img_url`: å›¾ç‰‡URL
- `audio_url`: éŸ³é¢‘URL

**ç®€åŒ–æ•ˆæœ**:
- âŒ ç§»é™¤ï¼šåˆ†é•œç¼–æ’ã€åŠ¨ç”»åŒ–ã€æ–‡å­—å­—å¹•ã€åˆæˆæ¸²æŸ“
- âœ… ä¿ç•™ï¼šå‰§æœ¬ç”Ÿæˆã€ç”»é¢æè¿°ã€å›¾åƒç”Ÿæˆã€éŸ³é¢‘ç”Ÿæˆ
- âœ… æ–°å¢ï¼šè§†é¢‘ç”Ÿæˆï¼ˆå›¾+éŸ³â†’è§†é¢‘ï¼‰ã€è§†é¢‘æ‹¼æ¥

---

## é˜¶æ®µè¯¦æƒ…

### ğŸ“¥ é˜¶æ®µ1: è¾“å…¥å¤„ç† (Input Processing)

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **åŠŸèƒ½** | æ¥æ”¶å¹¶é¢„å¤„ç†ç”¨æˆ·è¾“å…¥ |
| **è¾“å…¥** | æ–‡æœ¬/å‰§æœ¬/å…³é”®è¯ + é£æ ¼åå¥½ + å¯é€‰è§’è‰²/å›¾ç‰‡ |
| **è¾“å‡º** | `InputData` (æ ‡å‡†åŒ–è¾“å…¥æ•°æ®) |
| **æ ¸å¿ƒæŠ€æœ¯** | æ–‡æœ¬æ¸…æ´—ã€éªŒè¯è¯„åˆ†ã€ä¿¡æ¯æå– |

---

### ğŸ“– é˜¶æ®µ2: å‰§æœ¬ç”Ÿæˆ (Script Generation)

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **åŠŸèƒ½** | å°†ç”¨æˆ·è¾“å…¥è½¬åŒ–ä¸ºå®Œæ•´å‰§æœ¬ |
| **è¾“å…¥** | `InputData` (æ¥è‡ªé˜¶æ®µ1) |
| **è¾“å‡º** | `Script` (æ ‡é¢˜/åœºæ™¯/è§’è‰²/å¯¹è¯/èŠ‚å¥æ›²çº¿) |
| **æ ¸å¿ƒæŠ€æœ¯** | åƒé—®/GPT-4/Claude ç­‰ LLM |
| **ä¾èµ–** | é˜¶æ®µ1 |

**è¾“å‡ºæ•°æ®ç»“æ„**:
```python
Script {
    title: str              # å‰§æœ¬æ ‡é¢˜
    story_type: str         # æ•…äº‹ç±»å‹
    scenes: List[Scene]     # åœºæ™¯åˆ—è¡¨
    characters: Dict        # è§’è‰²è®¾å®š
    rhythm_curve: List      # èŠ‚å¥æ›²çº¿
}

Scene {
    order: int              # åºå·
    title: str              # åœºæ™¯æ ‡é¢˜
    description: str        # åœºæ™¯æè¿°
    atmosphere: str         # æ°›å›´
    characters: List[str]   # å‡ºåœºè§’è‰²
    dialog: str             # å¯¹è¯
    voiceover: str          # æ—ç™½/ç‹¬ç™½ï¼ˆç”¨äºTTSï¼‰
}
```

---

### ğŸ¨ é˜¶æ®µ3: ç”»é¢æè¿°ç”Ÿæˆ (Scene Description & Prompt Engineering)

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **åŠŸèƒ½** | å°†å‰§æœ¬è½¬åŒ–ä¸ºAIç»˜ç”»æç¤ºè¯å’Œè§†é¢‘æç¤ºè¯ |
| **è¾“å…¥** | `Script` (æ¥è‡ªé˜¶æ®µ2) + `StyleConfig` (æ¥è‡ªé˜¶æ®µ1) |
| **è¾“å‡º** | `ScenePrompts[]` (åœºæ™¯æç¤ºè¯åˆ—è¡¨) |
| **æ ¸å¿ƒæŠ€æœ¯** | LLM + Promptå·¥ç¨‹ |
| **ä¾èµ–** | é˜¶æ®µ1, é˜¶æ®µ2 |

**è¾“å‡ºæ•°æ®ç»“æ„**:
```python
ScenePrompt {
    scene_id: str           # åœºæ™¯ID
    image_prompt: str       # å›¾åƒç”Ÿæˆæç¤ºè¯
    video_prompt: str       # è§†é¢‘ç”Ÿæˆæç¤ºè¯ï¼ˆæ‰©å±•æè¿°ï¼‰
    composition: str        # æ„å›¾
    lighting: str           # å…‰å½±
    camera_angle: str       # æ‹æ‘„è§’åº¦
    shot_size: str          # æ™¯åˆ«
    style_tags: List[str]   # é£æ ¼æ ‡ç­¾
    quality_tags: List[str] # è´¨é‡æ ‡ç­¾
}
```

---

### ğŸ–¼ï¸ é˜¶æ®µ4: å›¾åƒç”Ÿæˆ (Image Generation)

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **åŠŸèƒ½** | æ ¹æ®æç¤ºè¯ç”Ÿæˆåœºæ™¯å›¾åƒ |
| **è¾“å…¥** | `ScenePrompts[]` + `Character` + `StyleConfig` |
| **è¾“å‡º** | `SceneImages[]` (é«˜åˆ†è¾¨ç‡å›¾åƒURL) |
| **æ ¸å¿ƒæŠ€æœ¯** | é€šä¹‰ä¸‡ç›¸/Flux/SD |
| **ä¾èµ–** | é˜¶æ®µ1, é˜¶æ®µ2, é˜¶æ®µ3 |

**æŠ€æœ¯æ ˆ**:
- **ä¸»æ¨¡å‹**: é€šä¹‰ä¸‡ç›¸ / Flux API / Stable Diffusion XL
- **è¾“å‡ºæ ¼å¼**: å…¬ç½‘å¯è®¿é—®çš„å›¾ç‰‡URL

**è¾“å‡ºæ•°æ®ç»“æ„**:
```python
SceneImage {
    scene_id: str           # åœºæ™¯ID
    image_url: str          # å›¾ç‰‡URLï¼ˆå…¬ç½‘å¯è®¿é—®ï¼‰
    image_path: str         # æœ¬åœ°è·¯å¾„
    seed: int               # ç”Ÿæˆç§å­
    metadata: Dict          # å…ƒæ•°æ®
}
```

---

### ğŸ”Š é˜¶æ®µ5: éŸ³é¢‘ç”Ÿæˆ (Audio Generation)

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **åŠŸèƒ½** | ç”Ÿæˆé…éŸ³ï¼ˆTTSï¼‰å’ŒèƒŒæ™¯éŸ³ä¹ |
| **è¾“å…¥** | `Script` (å¯¹è¯/æ—ç™½) + `VideoConfig` (æ—¶é•¿) |
| **è¾“å‡º** | `AudioTracks` (éŸ³é¢‘æ–‡ä»¶URL) |
| **æ ¸å¿ƒæŠ€æœ¯** | TTS + éŸ³ä¹ç”Ÿæˆ |
| **ä¾èµ–** | é˜¶æ®µ2 |

**æŠ€æœ¯æ ˆ**:
- **è¯­éŸ³åˆæˆ**: Azure TTS / Fish Audio / GPT-SoVITS
- **éŸ³ä¹ç”Ÿæˆ**: Suno / Udio / é€‰æ‹©BGMåº“

**è¾“å‡ºæ•°æ®ç»“æ„**:
```python
AudioTrack {
    scene_id: str           # åœºæ™¯ID
    audio_url: str          # éŸ³é¢‘URLï¼ˆå…¬ç½‘å¯è®¿é—®ï¼‰
    audio_path: str         # æœ¬åœ°è·¯å¾„
    duration: float         # æ—¶é•¿
    type: str               # ç±»å‹: dialogue/music/mixed
}
```

---

### ğŸ¬ é˜¶æ®µ6: è§†é¢‘ç”Ÿæˆ (Video Generation)

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **åŠŸèƒ½** | ä½¿ç”¨é€šä¹‰ä¸‡ç›¸wan2.6-i2vå°†å›¾ç‰‡+éŸ³é¢‘ç”Ÿæˆè§†é¢‘ |
| **è¾“å…¥** | `SceneImages[]` (å›¾ç‰‡URL) + `AudioTracks[]` (éŸ³é¢‘URL) + `ScenePrompts[]` |
| **è¾“å‡º** | `SceneVideos[]` (è§†é¢‘ç‰‡æ®µURL) |
| **æ ¸å¿ƒæŠ€æœ¯** | é€šä¹‰ä¸‡ç›¸ wan2.6-i2v API |
| **ä¾èµ–** | é˜¶æ®µ3, é˜¶æ®µ4, é˜¶æ®µ5 |

**APIè°ƒç”¨ç¤ºä¾‹**:
```bash
curl --location 'https://dashscope.aliyuncs.com/api/v1/services/aigc/video-generation/video-synthesis' \
    -H 'X-DashScope-Async: enable' \
    -H "Authorization: Bearer $DASHSCOPE_API_KEY" \
    -H 'Content-Type: application/json' \
    -d '{
    "model": "wan2.6-i2v",
    "input": {
        "prompt": "è§†é¢‘æè¿°æç¤ºè¯",
        "img_url": "å›¾ç‰‡URL",
        "audio_url": "éŸ³é¢‘URL"
    },
    "parameters": {
        "resolution": "720P",
        "prompt_extend": true,
        "duration": 10,
        "audio": true,
        "shot_type": "multi"
    }
}'
```

**è¾“å‡ºæ•°æ®ç»“æ„**:
```python
SceneVideo {
    scene_id: str           # åœºæ™¯ID
    video_url: str          # è§†é¢‘URL
    video_path: str         # æœ¬åœ°è·¯å¾„
    duration: float         # æ—¶é•¿
    task_id: str            # å¼‚æ­¥ä»»åŠ¡ID
    metadata: Dict          # å…ƒæ•°æ®
}
```

---

### ğŸï¸ é˜¶æ®µ7: è§†é¢‘æ‹¼æ¥ (Video Concat)

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **åŠŸèƒ½** | å°†å¤šä¸ªåœºæ™¯è§†é¢‘æ‹¼æ¥æˆå®Œæ•´è§†é¢‘ |
| **è¾“å…¥** | `SceneVideos[]` (è§†é¢‘ç‰‡æ®µåˆ—è¡¨) + `Script` (åœºæ™¯é¡ºåº) |
| **è¾“å‡º** | `FinalVideo` (å®Œæ•´è§†é¢‘æ–‡ä»¶) |
| **æ ¸å¿ƒæŠ€æœ¯** | FFmpeg |
| **ä¾èµ–** | é˜¶æ®µ2, é˜¶æ®µ6 |

**æŠ€æœ¯å®ç°**:
```bash
# ä½¿ç”¨FFmpegæ‹¼æ¥è§†é¢‘
ffmpeg -f concat -safe 0 -i file_list.txt -c copy output.mp4

# æˆ–ä½¿ç”¨æ»¤é•œè½¬åœºæ‹¼æ¥
ffmpeg -i scene1.mp4 -i scene2.mp4 -filter_complex "[0:v][1:v]xfade=transition=fade:duration=1:offset=5" output.mp4
```

**è¾“å‡ºæ•°æ®ç»“æ„**:
```python
FinalVideo {
    video_path: str         # è§†é¢‘è·¯å¾„
    duration: float         # æ€»æ—¶é•¿
    resolution: str         # åˆ†è¾¨ç‡
    format: str             # æ ¼å¼ (MP4)
    scene_count: int        # åœºæ™¯æ•°é‡
}
```

---

### ğŸ“¤ é˜¶æ®µ8: è¾“å‡ºäº¤ä»˜ (Output & Delivery)

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **åŠŸèƒ½** | æ ¼å¼åŒ–å¹¶æ‰“åŒ…äº¤ä»˜æ–‡ä»¶ |
| **è¾“å…¥** | `FinalVideo` |
| **è¾“å‡º** | `FinalOutput` (è§†é¢‘ + å…ƒæ•°æ®) |
| **æ ¸å¿ƒæŠ€æœ¯** | æ–‡ä»¶å¤„ç† |
| **ä¾èµ–** | é˜¶æ®µ7 |

**äº¤ä»˜å†…å®¹**:
```
FinalOutput/
â”œâ”€â”€ video.mp4          # ä¸»è§†é¢‘
â”œâ”€â”€ metadata.json      # å…ƒæ•°æ®ï¼ˆå‰§æœ¬ã€åœºæ™¯ä¿¡æ¯ï¼‰
â””â”€â”€ thumbnails/        # ç¼©ç•¥å›¾
```

---

## æ•°æ®ä¾èµ–å…³ç³»

```mermaid
graph LR
    subgraph Main["ä¸»çº¿æµç¨‹"]
        S1[é˜¶æ®µ1<br/>è¾“å…¥] --> S2[é˜¶æ®µ2<br/>å‰§æœ¬]
        S2 --> S3[é˜¶æ®µ3<br/>ç”»é¢æè¿°]
        S3 --> S4[é˜¶æ®µ4<br/>å›¾åƒ]
        S2 -.-> S5[é˜¶æ®µ5<br/>éŸ³é¢‘]
    end

    subgraph Video["è§†é¢‘ç”Ÿæˆ"]
        S3 --> S6[é˜¶æ®µ6<br/>è§†é¢‘ç”Ÿæˆ]
        S4 --> S6
        S5 --> S6
    end

    subgraph Final["æœ€ç»ˆè¾“å‡º"]
        S2 -.-> S7[é˜¶æ®µ7<br/>è§†é¢‘æ‹¼æ¥]
        S6 --> S7
        S7 --> S8[é˜¶æ®µ8<br/>è¾“å‡º]
    end
```

### é‡æ–°ç”Ÿæˆä¾èµ–è§„åˆ™

| é‡æ–°ç”Ÿæˆé˜¶æ®µ | éœ€è¦é‡æ–°æ‰§è¡Œ | è¯´æ˜ |
|-------------|-------------|------|
| é˜¶æ®µ2 (å‰§æœ¬) | é˜¶æ®µ3, 4, 5, 6, 7 | å‰§æœ¬æ”¹å˜ï¼Œåç»­å…¨æµç¨‹éœ€é‡æ–°æ‰§è¡Œ |
| é˜¶æ®µ3 (ç”»é¢) | é˜¶æ®µ4, 6, 7 | æç¤ºè¯æ”¹å˜ï¼Œå›¾åƒå’Œè§†é¢‘éœ€é‡æ–°ç”Ÿæˆ |
| é˜¶æ®µ4 (å›¾åƒ) | é˜¶æ®µ6, 7 | å›¾åƒæ”¹å˜ï¼Œè§†é¢‘éœ€é‡æ–°ç”Ÿæˆ |
| é˜¶æ®µ5 (éŸ³é¢‘) | é˜¶æ®µ6, 7 | éŸ³é¢‘æ”¹å˜ï¼Œè§†é¢‘éœ€é‡æ–°ç”Ÿæˆ |
| é˜¶æ®µ6 (è§†é¢‘) | é˜¶æ®µ7 | è§†é¢‘ç‰‡æ®µæ”¹å˜ï¼Œéœ€é‡æ–°æ‹¼æ¥ |

---

## æŠ€æœ¯æ ˆæ€»è§ˆ

| é˜¶æ®µ | ç±»åˆ« | äº‘ç«¯API | æœ¬åœ°æ¨¡å‹ |
|-----|------|---------|---------|
| 1 | è¾“å…¥å¤„ç† | - | - |
| 2 | å‰§æœ¬ç”Ÿæˆ | åƒé—® / Qwen / DeepSeek | Llama / Local |
| 3 | ç”»é¢æè¿° | åŒä¸Š | åŒä¸Š |
| 4 | å›¾åƒç”Ÿæˆ | é€šä¹‰ä¸‡ç›¸ / Flux | SDXL / SD3 |
| 5 | éŸ³é¢‘ç”Ÿæˆ | Azure / Fish / Suno | VITS / GPT-SoVITS |
| 6 | è§†é¢‘ç”Ÿæˆ | **é€šä¹‰ä¸‡ç›¸ wan2.6-i2v** | - |
| 7 | è§†é¢‘æ‹¼æ¥ | - | FFmpeg |
| 8 | è¾“å‡ºäº¤ä»˜ | - | - |

---

## é€šä¹‰ä¸‡ç›¸ wan2.6-i2v å‚æ•°è¯´æ˜

### APIå‚æ•°

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| `model` | str | å›ºå®šå€¼: `wan2.6-i2v` |
| `input.prompt` | str | è§†é¢‘ç”Ÿæˆæç¤ºè¯ |
| `input.img_url` | str | è¾“å…¥å›¾ç‰‡URLï¼ˆå…¬ç½‘å¯è®¿é—®ï¼‰ |
| `input.audio_url` | str | è¾“å…¥éŸ³é¢‘URLï¼ˆå…¬ç½‘å¯è®¿é—®ï¼‰ |
| `parameters.resolution` | str | åˆ†è¾¨ç‡: `720P` / `480P` |
| `parameters.prompt_extend` | bool | æ˜¯å¦æ‰©å±•æç¤ºè¯ |
| `parameters.duration` | int | è§†é¢‘æ—¶é•¿ï¼ˆç§’ï¼‰ |
| `parameters.audio` | bool | æ˜¯å¦ä½¿ç”¨éŸ³é¢‘ |
| `parameters.shot_type` | str | é•œå¤´ç±»å‹: `single` / `multi` |

### æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

```bash
curl --request GET 'https://dashscope.aliyuncs.com/api/v1/tasks/{task_id}' \
--header "Authorization: Bearer $DASHSCOPE_API_KEY"
```

### å“åº”ç¤ºä¾‹

```json
{
  "output": {
    "video_url": "https://xxx.mp4"
  },
  "task_id": "xxx",
  "task_status": "SUCCEEDED"
}
```

---

## å®ç°çŠ¶æ€

### è¿›åº¦æ¦‚è§ˆ

```
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  62.5% å®Œæˆ
```

### è¯¦ç»†çŠ¶æ€

| é˜¶æ®µ | çŠ¶æ€ | è¯´æ˜ |
|-----|------|------|
| 1. è¾“å…¥å¤„ç† | âœ… å·²å®ç° | Webç•Œé¢è¾“å…¥ã€éªŒè¯ |
| 2. å‰§æœ¬ç”Ÿæˆ | âœ… å·²å®ç° | ä½¿ç”¨åƒé—®LLM |
| 3. ç”»é¢æè¿° | âœ… å·²å®ç° | LLM + Promptå·¥ç¨‹ |
| 4. å›¾åƒç”Ÿæˆ | âœ… å·²å®ç° | ä½¿ç”¨é€šä¹‰ä¸‡ç›¸ |
| 5. éŸ³é¢‘ç”Ÿæˆ | ğŸš§ å¾…å®ç° | TTS + BGM |
| 6. è§†é¢‘ç”Ÿæˆ | ğŸš§ å¾…å®ç° | wan2.6-i2v API |
| 7. è§†é¢‘æ‹¼æ¥ | ğŸš§ å¾…å®ç° | FFmpegæ‹¼æ¥ |
| 8. è¾“å‡ºäº¤ä»˜ | ğŸš§ å¾…å®ç° | æ–‡ä»¶æ‰“åŒ… |

### å½“å‰åç«¯åŠŸèƒ½

- âœ… 4é˜¶æ®µæµç¨‹å±•ç¤ºï¼ˆè¾“å…¥â†’å‰§æœ¬â†’ç”»é¢â†’å›¾åƒï¼‰
- âœ… WebSocketå®æ—¶è¿›åº¦æ¨é€
- âœ… é€é˜¶æ®µé‡æ–°ç”Ÿæˆ
- âœ… ç€‘å¸ƒæµå¼å¸ƒå±€

### å¾…å¼€å‘åŠŸèƒ½

- ğŸš§ é˜¶æ®µ5: éŸ³é¢‘ç”Ÿæˆ
- ğŸš§ é˜¶æ®µ6: è§†é¢‘ç”Ÿæˆï¼ˆè°ƒç”¨wan2.6-i2vï¼‰
- ğŸš§ é˜¶æ®µ7: è§†é¢‘æ‹¼æ¥
- ğŸš§ é˜¶æ®µ8: è¾“å‡ºäº¤ä»˜
- ğŸš§ æ‰©å±•Webç•Œé¢æ”¯æŒ8é˜¶æ®µæµç¨‹

---

*æ–‡æ¡£ç‰ˆæœ¬: 3.0*
*æœ€åæ›´æ–°: 2026-02-05*
*é‡å¤§å˜æ›´: ä½¿ç”¨é€šä¹‰ä¸‡ç›¸wan2.6-i2vç®€åŒ–è§†é¢‘ç”Ÿæˆæµç¨‹*
